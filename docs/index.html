<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adjusts the Number of Scans an NMR Performs Based on the Concentration of a Sample • NMRalter8r</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Adjusts the Number of Scans an NMR Performs Based on the Concentration of a Sample">
<meta property="og:description" content="Variable sample dilutions in NMR spectroscopy makes spectral comparison tricky. By adjusting the number of scans performed by an NMR based on the dilution of the sample can account for these dilution effects and make the data analysis more robust and accurate.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">NMRalter8r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="nmralter8r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#nmralter8r" class="anchor"></a>NMRalter8r</h1></div>
<!-- badges: start -->
<p>NMRalter8r began as part of my honours project where I was trying to remove the effects of dilution in NMR spectra, especially in urine. Urine concentrations are highly variable based on a number of factors such as food and water intake, lifestyle and behaviour, and this variation interferes with the multivariate statistics used to analyse NMR spectra. Therefore the goal of NMRalter8r is to calculate the signal to noise of the spectra and aims to make this constant across all samples acquired which would remove dilution effects. This is achieved through automating the NMR and calculating on the fly the number of scans needed to remove the effects of dilution.</p>
<!-- badges: end -->
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<!-- You can install the released version of NMRalter8r from [CRAN](https://CRAN.R-project.org) with:-->
<!--``` r-->
<!--install.packages("NMRalter8r")-->
<!--```-->
<!--And-->
<p>Currently NMRalter8r is only available on <a href="https://github.com/">GitHub</a>. The code to install can be found below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"kylebario/NMRalter8r"</span><span class="op">)</span></code></pre></div>
</div>
<div id="the-whole-game" class="section level2">
<h2 class="hasAnchor">
<a href="#the-whole-game" class="anchor"></a>The Whole Game</h2>
<p>NMRalter8r is not intended to be used by anyone but the NMR. Ideally, it is installed on the computer of the NMR and then the Jython script that calls on NMRalter8r is extracted from it and saved in Topspin. From there, the file can automate the NMR, controlling everything from the type of experiment performed to the holder position of the sample. This Jython script is what talks to NMRalter8r and what catches the altered number of scans once it is calculated. But there is an intended pipeline to be followed when setting up the script for when Jython parses NMRalter8r the small scans which can be seen below. Feel free to alter it how you wish.</p>
</div>
<div id="standard-pipeline" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-pipeline" class="anchor"></a>Standard Pipeline</h2>
<p>This is the intended pipeline for any altered number of scans calculations:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">NMRalter8r</span><span class="op">)</span>
<span class="fu"><a href="reference/readin.html">readin</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'extdata/15'</span>, package <span class="op">=</span> <span class="st">'NMRalter8r'</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">x</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, col<span class="op">=</span><span class="st">'red'</span>, main <span class="op">=</span> <span class="st">"Preprocessed &amp; Non-Preprocessed NMR Spectrum"</span>, xlab <span class="op">=</span> <span class="st">'Chemical Shift (ppm)'</span>, ylab <span class="op">=</span> <span class="st">'Intensity'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Non-Processed"</span>, <span class="st">"Processed"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="reference/pproc.html">pproc</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">x</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, col<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/crea.html">crea</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span>, <span class="va">n</span>, c3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3.1</span><span class="op">)</span>, c4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4.1</span><span class="op">)</span><span class="op">)</span>
<span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/alter8r.html">alter8r</a></span><span class="op">(</span>sig <span class="op">=</span> <span class="va">cr</span>, noi <span class="op">=</span> <span class="va">n</span>, goal <span class="op">=</span> <span class="fl">40000</span>, ns <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">a_NS</span>, r2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">512</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span>
<span class="co">#&gt; 8</span></code></pre></div>
<div id="readin" class="section level3">
<h3 class="hasAnchor">
<a href="#readin" class="anchor"></a>readin</h3>
<p>As you an see, the <code><a href="reference/readin.html">readin()</a></code> function reads in the NMR spectrum (red) from the specified path.</p>
</div>
<div id="pproc" class="section level3">
<h3 class="hasAnchor">
<a href="#pproc" class="anchor"></a>pproc</h3>
<p>The <code><a href="reference/pproc.html">pproc()</a></code> function then performs multiple changes to the red spectrum to create the blue spectrum.</p>
<ol>
<li>First it calibrates the spectrum to the TSP signal (hence why the blue spectrum is slightly shift to the left).<br>
</li>
<li>Then it removes the lower, water, urea and upper regions of the spectra (hence why the red spectrum is longer and has those extra peaks between 4 and 6) that do not mean anything to the analysis.<br>
</li>
<li>Thirdly, a baseline correction is performed to remove signals from large molecules that we do not want to look at.<br>
</li>
<li>Finally, a noise estimation is calculated for further use in the <code><a href="reference/alter8r.html">alter8r()</a></code> function as well as others.<br><!-- end of list --><br>
This follows the standard pipeline for processing NMR spectra and lays the foundation for robust anaylsis.</li>
</ol>
</div>
<div id="crea" class="section level3">
<h3 class="hasAnchor">
<a href="#crea" class="anchor"></a>crea</h3>
<p>The <code><a href="reference/crea.html">crea()</a></code> function then estimates the height of the creatinine peak within the spectrum to gauge what the signal is.</p>
</div>
<div id="alter8r" class="section level3">
<h3 class="hasAnchor">
<a href="#alter8r" class="anchor"></a>alter8r</h3>
<p><code><a href="reference/alter8r.html">alter8r()</a></code> is the keystone function of NMRalter8r (as the name suggests). This function calculates the necessary number of scans need to be performed on a sample to make it have the set signal to noise. The function relies on the square root relationship between signal to noise and the number of scans performed by the NMR.</p>
</div>
</div>
<div id="features" class="section level2">
<h2 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h2>
<p>NMRalter8r is equipped with a range of preprocessing tools designed to overcome a number of issues that commonly occur when working with NMR data.</p>
<div id="flip" class="section level3">
<h3 class="hasAnchor">
<a href="#flip" class="anchor"></a>Flip</h3>
<p>A common problem with NMR spectra acquired with a small number of scans is that the processing done by Topspin will flip them the wrong way because the water peak is so much larger than the other peaks. NMRalter8r contains a function – <code>flip()</code> – that checks and corrects for this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">NMRalter8r</span><span class="op">)</span>
<span class="fu"><a href="reference/readin.html">readin</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'extdata/4'</span>, package <span class="op">=</span> <span class="st">'NMRalter8r'</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">x</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, col<span class="op">=</span><span class="st">'red'</span>, main <span class="op">=</span> <span class="st">"Disorientated NMR Spectrum"</span>, xlab <span class="op">=</span> <span class="st">'Chemical Shift (ppm)'</span>, ylab <span class="op">=</span> <span class="st">'Intensity'</span><span class="op">)</span>
<span class="va">xf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/flip_.html">flip_</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span>, sh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">xf</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, col<span class="op">=</span><span class="st">'blue'</span>, main <span class="op">=</span> <span class="st">"Orientated NMR Spectrum"</span>, xlab <span class="op">=</span> <span class="st">'Chemical Shift (ppm)'</span>, ylab <span class="op">=</span> <span class="st">'Intensity'</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p><code>flip()</code> works by multiplying all values within the spectrum by -1 to reorientate it based on whether or not the creatinine peak (or whatever peak is between the supply values in the sh argument) has a positive or negative sum</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Kyle Bario <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/https://orcid.org/0000-0003-3781-8220" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Torben Kimhofer <br><small class="roles"> Author, contributor </small> <a href="https://orcid.org/https://orcid.org/0000-0001-7158-9930" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Kyle Bario, Torben Kimhofer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
